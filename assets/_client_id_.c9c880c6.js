import{_ as Q}from"./ButtonOpacityBorder.818f8f48.js";import W from"./Delete.a0b00e61.js";import{_ as X,u as Y}from"./useFormatDate.13aa3706.js";import{u as Z,_ as ee}from"./RemoveClient.vue.c7dbf97a.js";import{_ as te}from"./AlertDanger.6a92bb46.js";import{_ as oe}from"./AlertSuccess.ec46006b.js";import{_ as ne}from"./Client.vue.f03ccbdd.js";import{_ as ae}from"./Header2.4a7e7163.js";import{_ as se}from"./ModalOrderDetails.vue.98a87f8a.js";import{_ as ie}from"./ButtonSortingTable.vue.5bd5532a.js";import{_ as le,a as re,b as me,c as pe,d as ue,e as _e}from"./Table.vue.3eadd202.js";import{_ as ce}from"./CurrencyText.399bb8ad.js";import{u as A,_ as de}from"./useDate.74e5cd5e.js";import{f as O,o as v,j as b,w as e,d as s,t as y,l as m,b as a,m as H,i as _,q as N,c as F,s as L,F as ge,v as fe,x as ve,y as he,a as M,z as Ce,A as R,B as ye}from"./entry.c2771859.js";import{_ as Se}from"./ProfilePage.vue.1b4ba3c0.js";import{u as Ie}from"./useSorting.38fe8590.js";import"./ButtonOpacity.379d89d4.js";import"./nuxt-icon.149bdd0a.js";import"./Calendar.a04c4cf1.js";import"./nuxt-link.5cec4310.js";import"./tw-merge.bf8c0b66.js";import"./ui.config.bea9c3fb.js";import"./index.6b3d421b.js";import"./index.7077fce3.js";import"./uid.b97b1703.js";import"./Modal.vue.13b34250.js";import"./Photo.9811dbfe.js";import"./User.9011a3d8.js";import"./useBase64.937b19aa.js";import"./ArrowRight.1a90c07f.js";import"./ButtonText.dc6c0591.js";import"./cn.a642df04.js";import"./ArrowTop.22ea1a99.js";import"./Close.ca6dd9e5.js";import"./ThreeDots.81b27bfd.js";const be=O({__name:"TableItemShoppingHistory",props:{order:{}},emits:["showOrderDetails"],setup(w,{emit:$}){const S=w,t=$,d=()=>{t("showOrderDetails",S.order._id)};return(i,I)=>{const p=le,g=ce,D=re,h=me,o=de,c=pe;return v(),b(c,{isMobileClose:!0},{header:e(()=>{var u;return[s(y(("useDate"in i?i.useDate:m(A))((u=i.order)==null?void 0:u.date)),1)]}),elements:e(({active:u})=>[a(p,{vIf:u},{title:e(()=>[s("Дата покупки")]),value:e(()=>{var l;return[s(y(("useDate"in i?i.useDate:m(A))((l=i.order)==null?void 0:l.date)),1)]}),_:2},1032,["vIf"]),a(p,{vIf:u},{title:e(()=>[s("Сума замовлення")]),value:e(()=>{var l;return[s(y((l=i.order)==null?void 0:l.total_sum),1),a(g)]}),_:2},1032,["vIf"]),a(p,{vIf:u},{title:e(()=>[s("Товари")]),value:e(()=>{var l;return[s(y((l=i.order)==null?void 0:l.products.length),1)]}),_:2},1032,["vIf"]),a(p,{vIf:u},{title:e(()=>[s("Оплата")]),value:e(()=>{var l;return[s(y((l=i.order)==null?void 0:l.payment),1)]}),_:2},1032,["vIf"]),i.order.status?(v(),b(p,{key:0,vIf:u,class:"3xl:w-[12%]"},{title:e(()=>[s("Статус замовлення")]),value:e(()=>[a(D,{color:i.order.status.colour},{default:e(()=>{var l;return[s(y((l=i.order)==null?void 0:l.status.status),1)]}),_:1},8,["color"])]),_:2},1032,["vIf"])):H("",!0),a(p,{vIf:u,class:"3xl:hidden col-span-2"},{title:e(()=>[a(h,{onClick:d},{default:e(()=>[s("Детальніше")]),_:1})]),_:2},1032,["vIf"])]),"additional-buttons":e(()=>[a(o,{onClick:d,class:"hidden 3xl:block"})]),_:1})}}}),De=O({__name:"ClientShoppingHistory",props:{emailClient:{},shoppingHistoryItems:{},page:{},endPage:{},sorting:{},reverseSorting:{type:Boolean}},emits:["setPage","setSorting"],setup(w,{emit:$}){const S=w,t=$,d=o=>{t("setPage",o)},i=o=>{t("setSorting",o)},I=_(""),p=_(!1),g=o=>{p.value=o},D=o=>{I.value=o,g(!0)},h=N(()=>S.shoppingHistoryItems?S.shoppingHistoryItems.find(o=>o._id===I.value):!1);return(o,c)=>{const u=ae,l=se,U=ie,C=ue,k=be,P=_e;return v(),F("div",null,[a(u,null,{default:e(()=>[s("Історія покупок")]),_:1}),m(h)?(v(),b(l,{key:0,products:m(h).products,modelValue:m(p),"onUpdate:modelValue":c[0]||(c[0]=f=>L(p)?p.value=f:null),label:"Деталі замовлення",onCloseModal:g},null,8,["products","modelValue"])):H("",!0),a(P,{pageTable:o.page,endPage:o.endPage,onSetPage:d},{headers:e(()=>[a(C,null,{default:e(()=>[a(U,{sortingUp:o.sorting==="order_date"&&o.reverseSorting,sortingDown:o.sorting==="order_date"&&!o.reverseSorting,onClick:c[1]||(c[1]=f=>i("order_date")),class:"!font-normal"},{default:e(()=>[s(" Дата покупки")]),_:1},8,["sortingUp","sortingDown"])]),_:1}),a(C,null,{default:e(()=>[a(U,{sortingUp:o.sorting==="total_sum"&&o.reverseSorting,sortingDown:o.sorting==="total_sum"&&!o.reverseSorting,onClick:c[2]||(c[2]=f=>i("total_sum")),class:"!font-normal"},{default:e(()=>[s(" Сума замовлення")]),_:1},8,["sortingUp","sortingDown"])]),_:1}),a(C,null,{default:e(()=>[s("Товари")]),_:1}),a(C,null,{default:e(()=>[s("Оплата")]),_:1}),a(C,null,{default:e(()=>[s("Статус замовлення")]),_:1})]),items:e(()=>[(v(!0),F(ge,null,fe(o.shoppingHistoryItems,f=>(v(),b(k,{key:f._id,order:f,onShowOrderDetails:D},null,8,["order"]))),128))]),_:1},8,["pageTable","endPage"])])}}}),$e={class:"items-center gap-[40px] hidden lg:flex"},ke={class:"flex flex-col items-center pb-[50px] gap-[20px] lg:hidden mt-[25px]"},rt=O({__name:"[client_id]",setup(w){Z();const $=ve(),S=N(()=>$.params.client_id),t=_({}),d=_({}),i=_(),I=_(""),p=_(""),g=_(1),D=_(1),h=_(""),o=_(!1),c=n=>{Ie(n,o,h,k)},u=n=>{g.value=n};he(g,()=>{k()},{deep:!0});const l=(n,r)=>{t.value[r]=n},U=()=>{const n=localStorage.getItem("token"),r=new FormData;r.append("additional_phone",t.value.additional_phone),r.append("email",t.value.email),r.append("gender",t.value.gender),r.append("birthday",Y(t.value.birthday)),r.append("instagram",t.value.instagram),r.append("telegram",t.value.telegram),r.append("comment",t.value.comment),r.append("status",t.value.status),r.append("userpic",t.value.userpic),r.append("phone",t.value.phone),r.append("name",t.value.name),r.append("access_token",n||""),i.value=r},C=()=>{U(),Ce(`${R()}/update_client/${S.value}`,{method:"POST",body:i.value}).then(n=>{n.message==="Client updated successfully"?p.value="Клієнт успішно оновився!":I.value="Щось не вийшло!"})},k=()=>{ye(`${R()}/client_info`,{body:{client_id:S.value,page:g.value,per_page:5,sort_by:h.value,reverse_sort:o.value}}).then(n=>{D.value=n.total_pages,d.value=n.client_info,t.value.additional_phone=n.client_info.additional_phone,t.value.birthday=n.client_info.birthday,t.value.comment=n.client_info.comment,t.value.email=n.client_info.email,t.value.gender=n.client_info.gender,t.value.instagram=n.client_info.instagram,t.value.name=n.client_info.name,t.value.phone=n.client_info.phone,t.value.status=n.client_info.status.status,t.value.telegram=n.client_info.telegram,t.value.userpic=n.client_info.userpic})},P=n=>{T.value=n},f=n=>{P(!0)},T=_(!1);return k(),(n,r)=>{const B=Q,V=W,x=X,j=ee,q=te,z=oe,E=ne,G=De,J=Se;return v(),b(J,{title:"Редагувати клієнта"},{header:e(()=>[M("div",$e,[a(B,{onClick:C},{default:e(()=>[s(" Оновити ")]),_:1}),a(x,{onClick:f,value:"Видалити",class:"w-fit"},{default:e(()=>[a(V,{class:"-order-10"})]),_:1})])]),content:e(()=>[a(j,{modelValue:m(T),"onUpdate:modelValue":r[0]||(r[0]=K=>L(T)?T.value=K:null),clientId:m(d)._id,onSwitchModal:P},null,8,["modelValue","clientId"]),m(I)?(v(),b(q,{key:0},{default:e(()=>[s(y(m(I)),1)]),_:1})):H("",!0),m(p)?(v(),b(z,{key:1},{default:e(()=>[s(y(m(p)),1)]),_:1})):H("",!0),a(E,{labelStatus:"Змінити статус клієнта:",inputs:m(t),onUpdateInputs:l},null,8,["inputs"]),a(G,{shoppingHistoryItems:m(d).orders,emailClient:m(d).email,page:m(g),endPage:m(D),sorting:m(h),reverseSorting:m(o),onSetSorting:c,onSetPage:u,class:"mt-[25px] xl:mt-[40px]"},null,8,["shoppingHistoryItems","emailClient","page","endPage","sorting","reverseSorting"]),M("div",ke,[a(B,{onClick:C},{default:e(()=>[s(" Оновити ")]),_:1}),a(x,{onClick:f,value:"Видалити",class:"w-fit"},{default:e(()=>[a(V,{class:"-order-10"})]),_:1})])]),_:1})}}});export{rt as default};
